<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="linux," />








  <link rel="shortcut icon" type="image/x-icon" href="/image/headimage.jpg?v=5.1.0" />






<meta name="description" content="linux命令">
<meta name="keywords" content="linux">
<meta property="og:type" content="article">
<meta property="og:title" content="linux基础命令(3)">
<meta property="og:url" content="http://yoursite.com/2017/03/15/linux基础命令3/index.html">
<meta property="og:site_name" content="knight_ka | 生活及学习笔记">
<meta property="og:description" content="linux命令">
<meta property="og:updated_time" content="2017-04-08T14:44:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="linux基础命令(3)">
<meta name="twitter:description" content="linux命令">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/03/15/linux基础命令3/"/>





  <title> linux基础命令(3) | knight_ka | 生活及学习笔记 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">knight_ka | 生活及学习笔记</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">生命不息|奋斗不止</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/15/linux基础命令3/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="knight_ka">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/image/headimage.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="knight_ka | 生活及学习笔记">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="knight_ka | 生活及学习笔记" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                linux基础命令(3)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-15T22:00:57+08:00">
                2017-03-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/03/15/linux基础命令3/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/03/15/linux基础命令3/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

	

          
          
             <span id="/2017/03/15/linux基础命令3/" class="leancloud_visitors" data-flag-title="linux基础命令(3)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
              <div class="post-description">
                  linux命令
              </div>
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="linux基础命令3"><a href="#linux基础命令3" class="headerlink" title="linux基础命令3"></a>linux基础命令3</h1><h2 id="iptables防火墙"><a href="#iptables防火墙" class="headerlink" title="iptables防火墙"></a>iptables防火墙</h2><p>#查看帮助<br>iptables -h<br>man iptables</p>
<p>列出iptables规则<br>iptables -L -n<br>列出iptables规则并显示规则编号<br>iptables -L -n –line-numbers</p>
<p>列出iptables nat表规则（默认是filter表）<br>iptables -L -n -t nat</p>
<p>清除默认规则（注意默认是filter表，如果对nat表操作要加-t nat）</p>
<p>#清楚所有规则<br>iptables -F </p>
<p>#重启iptables发现规则依然存在，因为没有保存<br>service iptables restart</p>
<p>#保存配置<br>service iptables save</p>
<p>#禁止ssh登陆（若果服务器在机房，一定要小心）<br>iptables -A INPUT -p tcp –dport 22 -j DROP</p>
<p>#删除规则<br>iptables -D INPUT -p tcp –dport 22 -j DROP<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-A, --append chain	追加到规则的最后一条</div><div class="line">-D, --delete chain [rulenum]	Delete rule rulenum (1 = first) from chain</div><div class="line">-I, --insert chain [rulenum]	Insert in chain as rulenum (default 1=first) 添加到规则的第一条</div><div class="line">-p, --proto  proto	protocol: by number or name, eg. &apos;tcp&apos;,常用协议有tcp、udp、icmp、all</div><div class="line">-j, --jump target 常见的行为有ACCEPT、DROP和REJECT三种，但一般不用REJECT，会带来安全隐患</div></pre></td></tr></table></figure></p>
<p>注意：INPUT和DROP这样的关键字需要大写</p>
<h3 id="禁止192-168-33-0网段从eth0网卡接入"><a href="#禁止192-168-33-0网段从eth0网卡接入" class="headerlink" title="禁止192.168.33.0网段从eth0网卡接入"></a>禁止192.168.33.0网段从eth0网卡接入</h3><p>iptables -A INPUT -p tcp -i eth0 -s 192.168.33.0 -j DROP<br>iptables -A INPUT -p tcp –dport 22 -i eth0 -s 192.168.33.61  -j ACCEPT</p>
<h3 id="禁止ip地址非192-168-10-10的所有类型数据接入"><a href="#禁止ip地址非192-168-10-10的所有类型数据接入" class="headerlink" title="禁止ip地址非192.168.10.10的所有类型数据接入"></a>禁止ip地址非192.168.10.10的所有类型数据接入</h3><p>iptables -A INPUT ! -s 192.168.10.10 -j DROP</p>
<h3 id="禁止ip地址非192-168-10-10的ping请求"><a href="#禁止ip地址非192-168-10-10的ping请求" class="headerlink" title="禁止ip地址非192.168.10.10的ping请求"></a>禁止ip地址非192.168.10.10的ping请求</h3><p>iptables -I INPUT -p icmp –icmp-type 8 -s 192.168.50.100 -j DROP</p>
<h3 id="扩展匹配：1-隐式扩展-2-显示扩展"><a href="#扩展匹配：1-隐式扩展-2-显示扩展" class="headerlink" title="扩展匹配：1.隐式扩展 2.显示扩展"></a>扩展匹配：1.隐式扩展 2.显示扩展</h3><pre><code>#隐式扩展
-p tcp
    --sport PORT 源端口
    --dport PORT 目标端口

#显示扩展：使用额外的匹配规则
-m EXTENSTION --SUB-OPT
-p tcp --dport 22 与 -p tcp -m tcp --dport 22功能相同

state：状态扩展，接口ip_contrack追踪会话状态
    NEW：新的连接请求
    ESTABLISHED：已建立的连接请求
    INVALID：非法连接
    RELATED：相关联的连接
</code></pre><h3 id="匹配端口范围"><a href="#匹配端口范围" class="headerlink" title="匹配端口范围"></a>匹配端口范围</h3><p>iptables -I INPUT -p tcp –dport 22:80 -j DROP</p>
<h3 id="匹配多个端口"><a href="#匹配多个端口" class="headerlink" title="匹配多个端口"></a>匹配多个端口</h3><p>iptables -I INPUT -p tcp -m multiport –dport 22,80,3306 -j ACCEPT</p>
<h3 id="不允许源端口为80的数据流出"><a href="#不允许源端口为80的数据流出" class="headerlink" title="不允许源端口为80的数据流出"></a>不允许源端口为80的数据流出</h3><p>iptables -I OUTPUT -p tcp –sport 80 -j DROP</p>
<h3 id="soct-cut-wc详解"><a href="#soct-cut-wc详解" class="headerlink" title="soct cut wc详解"></a>soct cut wc详解</h3><p>sort</p>
<blockquote>
<p>sort 命令对 File 参数指定的文件中的行排序，并将结果写到标准输出。如果 File 参数指定多个文件，那么 sort 命令将这些文件连接起来，并当作一个文件进行排序。</p>
</blockquote>
<p>sort语法</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@www ~]# sort [-fbMnrtuk] [file or stdin]</div></pre></td></tr></table></figure>
<p>选项与参数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">-f  ：忽略大小写的差异，例如 A 与 a 视为编码相同；</div><div class="line">-b  ：忽略最前面的空格符部分；</div><div class="line">-M  ：以月份的名字来排序，例如 JAN, DEC 等等的排序方法；</div><div class="line">-n  ：使用『纯数字』进行排序(默认是以文字型态来排序的)；</div><div class="line">-r  ：反向排序；</div><div class="line">-u  ：就是 uniq ，相同的数据中，仅出现一行代表；</div><div class="line">-t  ：分隔符，默认是用 [tab] 键来分隔；</div><div class="line">-k  ：以那个区间 (field) 来进行排序的意思</div></pre></td></tr></table></figure></p>
<p>对/etc/passwd 的账号进行排序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[root@www ~]# cat /etc/passwd | sort</div><div class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</div><div class="line">apache:x:48:48:Apache:/var/www:/sbin/nologin</div><div class="line">bin:x:1:1:bin:/bin:/sbin/nologin</div><div class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</div></pre></td></tr></table></figure></p>
<p>sort 是默认以第一个数据来排序，而且默认是以字符串形式来排序,所以由字母 a 开始升序排序。</p>
<p><strong>/etc/passwd 内容是以 : 来分隔的，我想以第三栏来排序，该如何</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">[root@www ~]# cat /etc/passwd | sort -t &apos;:&apos; -k 3</div><div class="line">root:x:0:0:root:/root:/bin/bash</div><div class="line">uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin</div><div class="line">operator:x:11:0:operator:/root:/sbin/nologin</div><div class="line">bin:x:1:1:bin:/bin:/sbin/nologin</div><div class="line">games:x:12:100:games:/usr/games:/sbin/nologin</div><div class="line">默认是以字符串来排序的，如果想要使用数字排序：</div><div class="line"></div><div class="line">cat /etc/passwd | sort -t &apos;:&apos; -k 3n</div><div class="line">root:x:0:0:root:/root:/bin/bash</div><div class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</div><div class="line">bin:x:2:2:bin:/bin:/bin/sh</div><div class="line">默认是升序排序，如果要倒序排序，如下</div><div class="line"></div><div class="line">cat /etc/passwd | sort -t &apos;:&apos; -k 3nr</div><div class="line">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</div><div class="line">ntp:x:106:113::/home/ntp:/bin/false</div><div class="line">messagebus:x:105:109::/var/run/dbus:/bin/false</div><div class="line">sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin</div></pre></td></tr></table></figure></p>
<p>如果要对/etc/passwd,先以第六个域的第2个字符到第4个字符进行正向排序，再基于第一个域进行反向排序。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cat /etc/passwd |  sort -t&apos;:&apos; -k 6.2,6.4 -k 1r      </div><div class="line">sync:x:4:65534:sync:/bin:/bin/sync</div><div class="line">proxy:x:13:13:proxy:/bin:/bin/sh</div><div class="line">bin:x:2:2:bin:/bin:/bin/sh</div><div class="line">sys:x:3:3:sys:/dev:/bin/sh</div></pre></td></tr></table></figure></p>
<p>查看/etc/passwd有多少个shell:对/etc/passwd的第七个域进行排序，然后去重:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">cat /etc/passwd |  sort -t&apos;:&apos; -k 7 -u</div><div class="line">root:x:0:0:root:/root:/bin/bash</div><div class="line">syslog:x:101:102::/home/syslog:/bin/false</div><div class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</div><div class="line">sync:x:4:65534:sync:/bin:/bin/sync</div><div class="line">sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin</div></pre></td></tr></table></figure></p>
<h4 id="uniq"><a href="#uniq" class="headerlink" title="uniq"></a>uniq</h4><blockquote>
<p>uniq命令可以去除排序过的文件中的重复行，因此uniq经常和sort合用。也就是说，为了使uniq起作用，所有的重复行必须是相邻的。</p>
</blockquote>
<p>uniq语法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[root@www ~]# uniq [-icu]</div><div class="line">选项与参数：</div><div class="line">-i   ：忽略大小写字符的不同；</div><div class="line">-c  ：进行计数</div><div class="line">-u  ：只显示唯一的行</div></pre></td></tr></table></figure></p>
<p><strong>testfile的内容如下</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"># cat testfile</div><div class="line">hello</div><div class="line">world</div><div class="line">friend</div><div class="line">hello</div><div class="line">world</div><div class="line">hello</div><div class="line">``` </div><div class="line"></div><div class="line">**uniq testfile** </div><div class="line">```aidl</div><div class="line"># uniq testfile</div><div class="line">hello</div><div class="line">world</div><div class="line">friend</div></pre></td></tr></table></figure></p>
<p><strong>排序文件，并且去重</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#cat testfile | sort |uniq</div><div class="line">friend</div><div class="line">hello</div><div class="line">world</div></pre></td></tr></table></figure></p>
<p><strong>排序之后删除了重复行，同时在行首位置输出该行重复的次数</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#sort testfile | uniq -c</div><div class="line">1 friend</div><div class="line">3 hello</div><div class="line">2 world</div></pre></td></tr></table></figure></p>
<p><strong>仅显示存在重复的行，并在行首显示该行重复的次数</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#sort testfile | uniq -dc</div><div class="line">3 hello</div><div class="line">2 world</div></pre></td></tr></table></figure></p>
<p><strong>仅显示不重复的行</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sort testfile | uniq -u</div><div class="line">friend</div></pre></td></tr></table></figure></p>
<h4 id="cut命令"><a href="#cut命令" class="headerlink" title="cut命令"></a>cut命令</h4><blockquote>
<p>cut命令可以从一个文本文件或者文本流中提取文本列。</p>
</blockquote>
<p>cut语法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[root@www ~]# cut -d&apos;分隔字符&apos; -f fields &lt;==用于有特定分隔字符</div><div class="line">[root@www ~]# cut -c 字符区间            &lt;==用于排列整齐的信息</div><div class="line">选项与参数：</div><div class="line">-d  ：后面接分隔字符。与 -f 一起使用；</div><div class="line">-f  ：依据 -d 的分隔字符将一段信息分割成为数段，用 -f 取出第几段的意思；</div><div class="line">-c  ：以字符 (characters) 的单位取出固定字符区间；</div></pre></td></tr></table></figure></p>
<p>PATH 变量如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@www ~]# echo $PATH</div><div class="line">/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/usr/X11R6/bin:/usr/games</div><div class="line">1 | 2       | 3   | 4       | 5            | 6            | 7</div></pre></td></tr></table></figure></p>
<p>将 PATH 变量取出，我要找出第五个路径。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#echo $PATH | cut -d &apos;:&apos; -f 5</div><div class="line">/usr/local/bin</div></pre></td></tr></table></figure></p>
<p>将 PATH 变量取出，我要找出第三和第五个路径。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#echo $PATH | cut -d &apos;:&apos; -f 3,5</div><div class="line">/sbin:/usr/local/bin</div></pre></td></tr></table></figure></p>
<p>将 PATH 变量取出，我要找出第三到最后一个路径。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># echo $PATH | cut -d &apos;:&apos; -f 3-</div><div class="line">/sbin:/usr/sbin:/usr/local/bin:/usr/X11R6/bin:/usr/games</div></pre></td></tr></table></figure></p>
<p>将 PATH 变量取出，我要找出第一到第三个路径。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#echo $PATH | cut -d &apos;:&apos; -f 1-3</div><div class="line">/bin:/usr/bin:/sbin:</div></pre></td></tr></table></figure></p>
<p>将 PATH 变量取出，我要找出第一到第三，还有第五个路径。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># echo $PATH | cut -d &apos;:&apos; -f 1-3,5</div><div class="line">/bin:/usr/bin:/sbin:/usr/local/bin</div></pre></td></tr></table></figure></p>
<p>实用例子:只显示/etc/passwd的用户和shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#cat /etc/passwd | cut -d &apos;:&apos; -f 1,7 </div><div class="line">root:/bin/bash</div><div class="line">daemon:/bin/sh</div><div class="line">bin:/bin/sh</div></pre></td></tr></table></figure></p>
<h4 id="wc"><a href="#wc" class="headerlink" title="wc"></a>wc</h4><blockquote>
<p>统计文件里面有多少单词，多少行，多少字符。</p>
</blockquote>
<p>wc语法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[root@www ~]# wc [-lwm]</div><div class="line">选项与参数：</div><div class="line">-l  ：仅列出行；</div><div class="line">-w  ：仅列出多少字(英文单字)；</div><div class="line">-m  ：多少字符；</div></pre></td></tr></table></figure></p>
<p>默认使用wc统计/etc/passwd<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#wc /etc/passwd</div><div class="line">40   45 1719 /etc/passwd</div><div class="line">40是行数，45是单词数，1719是字节数</div></pre></td></tr></table></figure></p>
<p>wc的命令比较简单使用，每个参数使用如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#wc -l /etc/passwd   #统计行数，在对记录数时，很常用</div><div class="line">40 /etc/passwd       #表示系统有40个账户</div><div class="line"></div><div class="line">#wc -w /etc/passwd  #统计单词出现次数</div><div class="line">45 /etc/passwd</div><div class="line"></div><div class="line">#wc -m /etc/passwd  #统计文件的字符数</div><div class="line">1719</div></pre></td></tr></table></figure></p>
<p>参考:<a href="http://vbird.dic.ksu.edu.tw/linux_basic/0320bash_6.php#pipe_2" target="_blank" rel="external">http://vbird.dic.ksu.edu.tw/linux_basic/0320bash_6.php#pipe_2</a></p>
<p><a href="http://www.cnblogs.com/stephen-liu74/archive/2011/11/10/2240461.html" target="_blank" rel="external">http://www.cnblogs.com/stephen-liu74/archive/2011/11/10/2240461.html</a></p>
<h3 id="sed操作文本"><a href="#sed操作文本" class="headerlink" title="sed操作文本"></a>sed操作文本</h3><ol>
<li>Sed简介<br>sed 是一种在线编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。接着处理下一行，这样不断重复，直到文件末尾。文件内容并没有 改变，除非你使用重定向存储输出。Sed主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。以下介绍的是Gnu版本的Sed 3.02。</li>
<li><p>定址<br>可以通过定址来定位你所希望编辑的行，该地址用数字构成，用逗号分隔的两个行数表示以这两行为起止的行的范围（包括行数表示的那两行）。如1，3表示1，2，3行，美元符号($)表示最后一行。范围可以通过数据，正则表达式或者二者结合的方式确定 。</p>
</li>
<li><p>Sed命令<br>调用sed命令有两种形式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line">sed [options] &apos;command&apos; file(s)</div><div class="line">sed [options] -f scriptfile file(s)</div><div class="line">a\</div><div class="line">在当前行后面加入一行文本。</div><div class="line">b lable</div><div class="line">分支到脚本中带有标记的地方，如果分支不存在则分支到脚本的末尾。</div><div class="line">c\</div><div class="line">用新的文本改变本行的文本。</div><div class="line">d</div><div class="line">从模板块（Pattern space）位置删除行。</div><div class="line">D</div><div class="line">删除模板块的第一行。</div><div class="line">i\</div><div class="line">在当前行上面插入文本。</div><div class="line">h</div><div class="line">拷贝模板块的内容到内存中的缓冲区。</div><div class="line">H</div><div class="line">追加模板块的内容到内存中的缓冲区</div><div class="line">g</div><div class="line">获得内存缓冲区的内容，并替代当前模板块中的文本。</div><div class="line">G</div><div class="line">获得内存缓冲区的内容，并追加到当前模板块文本的后面。</div><div class="line">l</div><div class="line">列表不能打印字符的清单。</div><div class="line">n</div><div class="line">读取下一个输入行，用下一个命令处理新的行而不是用第一个命令。</div><div class="line">N</div><div class="line">追加下一个输入行到模板块后面并在二者间嵌入一个新行，改变当前行号码。</div><div class="line">p</div><div class="line">打印模板块的行。</div><div class="line">P（大写）</div><div class="line">打印模板块的第一行。</div><div class="line">q</div><div class="line">退出Sed。</div><div class="line">r file</div><div class="line">从file中读行。</div><div class="line">t label</div><div class="line">if分支，从最后一行开始，条件一旦满足或者T，t命令，将导致分支到带有标号的命令处，或者到脚本的末尾。</div><div class="line">T label</div><div class="line">错误分支，从最后一行开始，一旦发生错误或者T，t命令，将导致分支到带有标号的命令处，或者到脚本的末尾。</div><div class="line">w file</div><div class="line">写并追加模板块到file末尾。</div><div class="line">W file</div><div class="line">写并追加模板块的第一行到file末尾。</div><div class="line">!</div><div class="line">表示后面的命令对所有没有被选定的行发生作用。</div><div class="line">s/re/string</div><div class="line">用string替换正则表达式re。</div><div class="line">=</div><div class="line">打印当前行号码。</div><div class="line">#</div><div class="line">把注释扩展到下一个换行符以前。</div><div class="line">以下的是替换标记</div><div class="line">*</div><div class="line">g表示行内全面替换。</div><div class="line">*</div><div class="line">p表示打印行。</div><div class="line">*</div><div class="line">w表示把行写入一个文件。</div><div class="line">*</div><div class="line">x表示互换模板块中的文本和缓冲区中的文本。</div><div class="line">*</div><div class="line">y表示把一个字符翻译为另外的字符（但是不用于正则表达式）</div></pre></td></tr></table></figure>
</li>
<li><p>选项</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">-e command, --expression=command</div><div class="line">允许多台编辑。</div><div class="line">-h, --help</div><div class="line">打印帮助，并显示bug列表的地址。</div><div class="line">-n, --quiet, --silent</div><div class="line">取消默认输出。</div><div class="line">-f, --filer=script-file</div><div class="line">引导sed脚本文件名。</div><div class="line">-V, --version</div><div class="line">打印版本和版权信息。</div></pre></td></tr></table></figure>
</li>
<li><p>元字符集^</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">锚定行的开始 如：/^sed/匹配所有以sed开头的行。 </div><div class="line">$</div><div class="line">锚定行的结束 如：/sed$/匹配所有以sed结尾的行。 </div><div class="line">.</div><div class="line">匹配一个非换行符的字符 如：/s.d/匹配s后接一个任意字符，然后是d。 </div><div class="line">*</div><div class="line">匹配零或多个字符 如：/*sed/匹配所有模板是一个或多个空格后紧跟sed的行。 </div><div class="line">[]</div><div class="line">匹配一个指定范围内的字符，如/[Ss]ed/匹配sed和Sed。 </div><div class="line">[^]</div><div class="line">匹配一个不在指定范围内的字符，如：/[^A-RT-Z]ed/匹配不包含A-R和T-Z的一个字母开头，紧跟ed的行。 </div><div class="line">\(..\)</div><div class="line">保存匹配的字符，如s/\(love\)able/\1rs，loveable被替换成lovers。 </div><div class="line">&amp;</div><div class="line">保存搜索字符用来替换其他字符，如s/love/**&amp;**/，love这成**love**。 </div><div class="line">\&lt;</div><div class="line">锚定单词的开始，如:/\&lt;love/匹配包含以love开头的单词的行。 </div><div class="line">\&gt;</div><div class="line">锚定单词的结束，如/love\&gt;/匹配包含以love结尾的单词的行。 </div><div class="line">x\&#123;m\&#125;</div><div class="line">重复字符x，m次，如：/o\&#123;5\&#125;/匹配包含5个o的行。 </div><div class="line">x\&#123;m,\&#125;</div><div class="line">重复字符x,至少m次，如：/o\&#123;5,\&#125;/匹配至少有5个o的行。 </div><div class="line">x\&#123;m,n\&#125;</div><div class="line">重复字符x，至少m次，不多于n次，如：/o\&#123;5,10\&#125;/匹配5--10个o的行。</div></pre></td></tr></table></figure>
</li>
<li><p>实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line">删除：d命令</div><div class="line">*</div><div class="line">$ sed &apos;2d&apos; example-----删除example文件的第二行。</div><div class="line">*</div><div class="line">$ sed &apos;2,$d&apos; example-----删除example文件的第二行到末尾所有行。</div><div class="line">*</div><div class="line">$ sed &apos;$d&apos; example-----删除example文件的最后一行。</div><div class="line">*</div><div class="line">$ sed &apos;/test/&apos;d example-----删除example文件所有包含test的行。</div><div class="line">替换：s命令</div><div class="line">*</div><div class="line">$ sed &apos;s/test/mytest/g&apos; example-----在整行范围内把test替换为mytest。如果没有g标记，则只有每行第一个匹配的test被替换成mytest。</div><div class="line">*</div><div class="line">$ sed -n &apos;s/^test/mytest/p&apos; example-----(-n)选项和p标志一起使用表示只打印那些发生替换的行。也就是说，如果某一行开头的test被替换成mytest，就打印它。</div><div class="line">*</div><div class="line">$ sed &apos;s/^192.168.0.1/&amp;localhost/&apos; example-----&amp;符号表示替换换字符串中被找到的部份。所有以192.168.0.1开头的行都会被替换成它自已加 localhost，变成192.168.0.1localhost。</div><div class="line">*</div><div class="line">$ sed -n &apos;s/\(love\)able/\1rs/p&apos; example-----love被标记为1，所有loveable会被替换成lovers，而且替换的行会被打印出来。</div><div class="line">*</div><div class="line">$ sed &apos;s#10#100#g&apos; example-----不论什么字符，紧跟着s命令的都被认为是新的分隔符，所以，“#”在这里是分隔符，代替了默认的“/”分隔符。表示把所有10替换成100。</div><div class="line">选定行的范围：逗号</div><div class="line">*</div><div class="line">$ sed -n &apos;/test/,/check/p&apos; example-----所有在模板test和check所确定的范围内的行都被打印。</div><div class="line">*</div><div class="line">$ sed -n &apos;5,/^test/p&apos; example-----打印从第五行开始到第一个包含以test开始的行之间的所有行。</div><div class="line">*</div><div class="line">$ sed &apos;/test/,/check/s/$/sed test/&apos; example-----对于模板test和west之间的行，每行的末尾用字符串sed test替换。</div><div class="line">多点编辑：e命令</div><div class="line">*</div><div class="line">$ sed -e &apos;1,5d&apos; -e &apos;s/test/check/&apos; example-----(-e)选项允许在同一行里执行多条命令。如例子所示，第一条命令删除1至5行，第二条命令用check替换test。命令的执 行顺序对结果有影响。如果两个命令都是替换命令，那么第一个替换命令将影响第二个替换命令的结果。</div><div class="line">*</div><div class="line">$ sed --expression=&apos;s/test/check/&apos; --expression=&apos;/love/d&apos; example-----一个比-e更好的命令是--expression。它能给sed表达式赋值。</div><div class="line">从文件读入：r命令</div><div class="line">*</div><div class="line">$ sed &apos;/test/r file&apos; example-----file里的内容被读进来，显示在与test匹配的行后面，如果匹配多行，则file的内容将显示在所有匹配行的下面。</div><div class="line">写入文件：w命令</div><div class="line">*</div><div class="line">$ sed -n &apos;/test/w file&apos; example-----在example中所有包含test的行都被写入file里。</div><div class="line">追加命令：a命令</div><div class="line">*</div><div class="line">$ sed &apos;/^test/a\\---&gt;this is a example&apos; example    &apos;-----&gt;this is a example&apos;被追加到以test开头的行后面，sed要求命令a后面有一个反斜杠。</div><div class="line">插入：i命令</div><div class="line">$ sed &apos;/test/i\\</div><div class="line">new line</div><div class="line">-------------------------&apos; example</div><div class="line">如果test被匹配，则把反斜杠后面的文本插入到匹配行的前面。</div><div class="line">下一个：n命令</div><div class="line">*</div><div class="line">$ sed &apos;/test/&#123; n; s/aa/bb/; &#125;&apos; example-----如果test被匹配，则移动到匹配行的下一行，替换这一行的aa，变为bb，并打印该行，然后继续。</div><div class="line">变形：y命令</div><div class="line">*</div><div class="line">$ sed &apos;1,10y/abcde/ABCDE/&apos; example-----把1--10行内所有abcde转变为大写，注意，正则表达式元字符不能使用这个命令。</div><div class="line">退出：q命令</div><div class="line">*</div><div class="line">$ sed &apos;10q&apos; example-----打印完第10行后，退出sed。</div><div class="line">保持和获取：h命令和G命令</div><div class="line">*</div><div class="line">$ sed -e &apos;/test/h&apos; -e &apos;$G example-----在sed处理文件的时候，每一行都被保存在一个叫模式空间的临时缓冲区中，除非行被删除或者输出被取消，否则所有被处理的行都将 打印在屏幕上。接着模式空间被清空，并存入新的一行等待处理。在这个例子里，匹配test的行被找到后，将存入模式空间，h命令将其复制并存入一个称为保 持缓存区的特殊缓冲区内。第二条语句的意思是，当到达最后一行后，G命令取出保持缓冲区的行，然后把它放回模式空间中，且追加到现在已经存在于模式空间中 的行的末尾。在这个例子中就是追加到最后一行。简单来说，任何包含test的行都被复制并追加到该文件的末尾。</div><div class="line">保持和互换：h命令和x命令</div><div class="line">*</div><div class="line">$ sed -e &apos;/test/h&apos; -e &apos;/check/x&apos; example -----互换模式空间和保持缓冲区的内容。也就是把包含test与check的行互换。</div><div class="line">7. 脚本</div><div class="line">Sed脚本是一个sed的命令清单，启动Sed时以-f选项引导脚本文件名。Sed对于脚本中输入的命令非常挑剔，在命令的末尾不能有任何空白或文本，如果在一行中有多个命令，要用分号分隔。以#开头的行为注释行，且不能跨行。</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="awk操作文本"><a href="#awk操作文本" class="headerlink" title="awk操作文本"></a>awk操作文本</h3><p><strong>简介</strong></p>
<blockquote>
<p>awk是一个强大的文本分析工具，相对于grep的查找，sed的编辑，awk在其对数据分析并生成报告时，显得尤为强大。简单来说awk就是把文件逐行的读入，以空格为默认分隔符将每行切片，切开的部分再进行各种分析处理。</p>
<p>awk有3个不同版本: awk、nawk和gawk，未作特别说明，一般指gawk，gawk 是 AWK 的 GNU 版本。</p>
<p>awk其名称得自于它的创始人 Alfred Aho 、Peter Weinberger 和 Brian Kernighan 姓氏的首个字母。实际上 AWK 的确拥有自己的语言： AWK 程序设计语言 ， 三位创建者已将它正式定义为“样式扫描和处理语言”。它允许您创建简短的程序，这些程序读取输入文件、为数据排序、处理数据、对输入执行计算以及生成报表，还有无数其他的功能。</p>
</blockquote>
<p>使用方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div></pre></td><td class="code"><pre><div class="line">awk &apos;&#123;pattern + action&#125;&apos; &#123;filenames&#125;</div><div class="line">尽管操作可能会很复杂，但语法总是这样，其中 pattern 表示 AWK 在数据中查找的内容，而 action 是在找到匹配内容时所执行的一系列命令。花括号（&#123;&#125;）不需要在程序中始终出现，但它们用于根据特定的模式对一系列指令进行分组。 pattern就是要表示的正则表达式，用斜杠括起来。</div><div class="line"></div><div class="line">awk语言的最基本功能是在文件或者字符串中基于指定规则浏览和抽取信息，awk抽取信息后，才能进行其他文本操作。完整的awk脚本通常用来格式化文本文件中的信息。</div><div class="line"></div><div class="line">通常，awk是以文件的一行为处理单位的。awk每接收文件的一行，然后执行相应的命令，来处理文本。</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">调用awk</div><div class="line">有三种方式调用awk</div><div class="line"></div><div class="line"> </div><div class="line">1.命令行方式</div><div class="line">awk [-F  field-separator]  &apos;commands&apos;  input-file(s)</div><div class="line">其中，commands 是真正awk命令，[-F域分隔符]是可选的。 input-file(s) 是待处理的文件。</div><div class="line">在awk中，文件的每一行中，由域分隔符分开的每一项称为一个域。通常，在不指名-F域分隔符的情况下，默认的域分隔符是空格。</div><div class="line"></div><div class="line">2.shell脚本方式</div><div class="line">将所有的awk命令插入一个文件，并使awk程序可执行，然后awk命令解释器作为脚本的首行，一遍通过键入脚本名称来调用。</div><div class="line">相当于shell脚本首行的：#!/bin/sh</div><div class="line">可以换成：#!/bin/awk</div><div class="line"></div><div class="line">3.将所有的awk命令插入一个单独文件，然后调用：</div><div class="line">awk -f awk-script-file input-file(s)</div><div class="line">其中，-f选项加载awk-script-file中的awk脚本，input-file(s)跟上面的是一样的。</div><div class="line"> </div><div class="line"> 本章重点介绍命令行方式。</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">入门实例</div><div class="line">假设last -n 5的输出如下</div><div class="line"></div><div class="line">[root@www ~]# last -n 5 &lt;==仅取出前五行</div><div class="line">root     pts/1   192.168.1.100  Tue Feb 10 11:21   still logged in</div><div class="line">root     pts/1   192.168.1.100  Tue Feb 10 00:46 - 02:28  (01:41)</div><div class="line">root     pts/1   192.168.1.100  Mon Feb  9 11:41 - 18:30  (06:48)</div><div class="line">dmtsai   pts/1   192.168.1.100  Mon Feb  9 11:41 - 11:41  (00:00)</div><div class="line">root     tty1                   Fri Sep  5 14:09 - 14:10  (00:01)</div><div class="line">如果只是显示最近登录的5个帐号</div><div class="line"></div><div class="line">#last -n 5 | awk  &apos;&#123;print $1&#125;&apos;</div><div class="line">root</div><div class="line">root</div><div class="line">root</div><div class="line">dmtsai</div><div class="line">root</div><div class="line">awk工作流程是这样的：读入有&apos;\n&apos;换行符分割的一条记录，然后将记录按指定的域分隔符划分域，填充域，$0则表示所有域,$1表示第一个域,$n表示第n个域。默认域分隔符是&quot;空白键&quot; 或 &quot;[tab]键&quot;,所以$1表示登录用户，$3表示登录用户ip,以此类推。</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">如果只是显示/etc/passwd的账户</div><div class="line"></div><div class="line">#cat /etc/passwd |awk  -F &apos;:&apos;  &apos;&#123;print $1&#125;&apos;  </div><div class="line">root</div><div class="line">daemon</div><div class="line">bin</div><div class="line">sys</div><div class="line">这种是awk+action的示例，每行都会执行action&#123;print $1&#125;。</div><div class="line"></div><div class="line">-F指定域分隔符为&apos;:&apos;。</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">如果只是显示/etc/passwd的账户和账户对应的shell,而账户与shell之间以tab键分割</div><div class="line"></div><div class="line">#cat /etc/passwd |awk  -F &apos;:&apos;  &apos;&#123;print $1&quot;\t&quot;$7&#125;&apos;</div><div class="line">root    /bin/bash</div><div class="line">daemon  /bin/sh</div><div class="line">bin     /bin/sh</div><div class="line">sys     /bin/sh</div><div class="line"> </div><div class="line"></div><div class="line">如果只是显示/etc/passwd的账户和账户对应的shell,而账户与shell之间以逗号分割,而且在所有行添加列名name,shell,在最后一行添加&quot;blue,/bin/nosh&quot;。</div><div class="line"></div><div class="line"> </div><div class="line">cat /etc/passwd |awk  -F &apos;:&apos;  &apos;BEGIN &#123;print &quot;name,shell&quot;&#125;  &#123;print $1&quot;,&quot;$7&#125; END &#123;print &quot;blue,/bin/nosh&quot;&#125;&apos;</div><div class="line">name,shell</div><div class="line">root,/bin/bash</div><div class="line">daemon,/bin/sh</div><div class="line">bin,/bin/sh</div><div class="line">sys,/bin/sh</div><div class="line">....</div><div class="line">blue,/bin/nosh</div><div class="line"> </div><div class="line">awk工作流程是这样的：先执行BEGING，然后读取文件，读入有/n换行符分割的一条记录，然后将记录按指定的域分隔符划分域，填充域，$0则表示所有域,$1表示第一个域,$n表示第n个域,随后开始执行模式所对应的动作action。接着开始读入第二条记录······直到所有的记录都读完，最后执行END操作。</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">搜索/etc/passwd有root关键字的所有行</div><div class="line"></div><div class="line">#awk -F: &apos;/root/&apos; /etc/passwd</div><div class="line">root:x:0:0:root:/root:/bin/bash</div><div class="line">这种是pattern的使用示例，匹配了pattern(这里是root)的行才会执行action(没有指定action，默认输出每行的内容)。</div><div class="line"></div><div class="line">搜索支持正则，例如找root开头的: awk -F: &apos;/^root/&apos; /etc/passwd</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">搜索/etc/passwd有root关键字的所有行，并显示对应的shell</div><div class="line"></div><div class="line"># awk -F: &apos;/root/&#123;print $7&#125;&apos; /etc/passwd             </div><div class="line">/bin/bash</div><div class="line"> 这里指定了action&#123;print $7&#125;</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">awk内置变量</div><div class="line">awk有许多内置变量用来设置环境信息，这些变量可以被改变，下面给出了最常用的一些变量。</div><div class="line"></div><div class="line"> </div><div class="line">ARGC               命令行参数个数</div><div class="line">ARGV               命令行参数排列</div><div class="line">ENVIRON            支持队列中系统环境变量的使用</div><div class="line">FILENAME           awk浏览的文件名</div><div class="line">FNR                浏览文件的记录数</div><div class="line">FS                 设置输入域分隔符，等价于命令行 -F选项</div><div class="line">NF                 浏览记录的域的个数</div><div class="line">NR                 已读的记录数</div><div class="line">OFS                输出域分隔符</div><div class="line">ORS                输出记录分隔符</div><div class="line">RS                 控制记录分隔符</div><div class="line"> </div><div class="line"> 此外,$0变量是指整条记录。$1表示当前行的第一个域,$2表示当前行的第二个域,......以此类推。</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">统计/etc/passwd:文件名，每行的行号，每行的列数，对应的完整行内容:</div><div class="line"></div><div class="line">#awk  -F &apos;:&apos;  &apos;&#123;print &quot;filename:&quot; FILENAME &quot;,linenumber:&quot; NR &quot;,columns:&quot; NF &quot;,linecontent:&quot;$0&#125;&apos; /etc/passwd</div><div class="line">filename:/etc/passwd,linenumber:1,columns:7,linecontent:root:x:0:0:root:/root:/bin/bash</div><div class="line">filename:/etc/passwd,linenumber:2,columns:7,linecontent:daemon:x:1:1:daemon:/usr/sbin:/bin/sh</div><div class="line">filename:/etc/passwd,linenumber:3,columns:7,linecontent:bin:x:2:2:bin:/bin:/bin/sh</div><div class="line">filename:/etc/passwd,linenumber:4,columns:7,linecontent:sys:x:3:3:sys:/dev:/bin/sh</div><div class="line"> </div><div class="line"></div><div class="line">使用printf替代print,可以让代码更加简洁，易读</div><div class="line"></div><div class="line"> awk  -F &apos;:&apos;  &apos;&#123;printf(&quot;filename:%s,linenumber:%s,columns:%s,linecontent:%s\n&quot;,FILENAME,NR,NF,$0)&#125;&apos; /etc/passwd</div><div class="line"> </div><div class="line"></div><div class="line">print和printf</div><div class="line">awk中同时提供了print和printf两种打印输出的函数。</div><div class="line"></div><div class="line">其中print函数的参数可以是变量、数值或者字符串。字符串必须用双引号引用，参数用逗号分隔。如果没有逗号，参数就串联在一起而无法区分。这里，逗号的作用与输出文件的分隔符的作用是一样的，只是后者是空格而已。</div><div class="line"></div><div class="line">printf函数，其用法和c语言中printf基本相似,可以格式化字符串,输出复杂时，printf更加好用，代码更易懂。</div><div class="line"></div><div class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% </div><div class="line"></div><div class="line"> awk编程</div><div class="line"> 变量和赋值</div><div class="line"></div><div class="line">除了awk的内置变量，awk还可以自定义变量。</div><div class="line"></div><div class="line">下面统计/etc/passwd的账户人数</div><div class="line"></div><div class="line">awk &apos;&#123;count++;print $0;&#125; END&#123;print &quot;user count is &quot;, count&#125;&apos; /etc/passwd</div><div class="line">root:x:0:0:root:/root:/bin/bash</div><div class="line">......</div><div class="line">user count is  40</div><div class="line">count是自定义变量。之前的action&#123;&#125;里都是只有一个print,其实print只是一个语句，而action&#123;&#125;可以有多个语句，以;号隔开。</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">这里没有初始化count，虽然默认是0，但是妥当的做法还是初始化为0:</div><div class="line"></div><div class="line">awk &apos;BEGIN &#123;count=0;print &quot;[start]user count is &quot;, count&#125; &#123;count=count+1;print $0;&#125; END&#123;print &quot;[end]user count is &quot;, count&#125;&apos; /etc/passwd</div><div class="line">[start]user count is  0</div><div class="line">root:x:0:0:root:/root:/bin/bash</div><div class="line">...</div><div class="line">[end]user count is  40</div><div class="line"> </div><div class="line"></div><div class="line">统计某个文件夹下的文件占用的字节数</div><div class="line"></div><div class="line">ls -l |awk &apos;BEGIN &#123;size=0;&#125; &#123;size=size+$5;&#125; END&#123;print &quot;[end]size is &quot;, size&#125;&apos;</div><div class="line">[end]size is  8657198</div><div class="line"> </div><div class="line"></div><div class="line">如果以M为单位显示:</div><div class="line"></div><div class="line">ls -l |awk &apos;BEGIN &#123;size=0;&#125; &#123;size=size+$5;&#125; END&#123;print &quot;[end]size is &quot;, size/1024/1024,&quot;M&quot;&#125;&apos; </div><div class="line">[end]size is  8.25889 M</div><div class="line">注意，统计不包括文件夹的子目录。</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">条件语句</div><div class="line"></div><div class="line"> awk中的条件语句是从C语言中借鉴来的，见如下声明方式：</div><div class="line"></div><div class="line"> </div><div class="line">if (expression) &#123;</div><div class="line">    statement;</div><div class="line">    statement;</div><div class="line">    ... ...</div><div class="line">&#125;</div><div class="line"></div><div class="line">if (expression) &#123;</div><div class="line">    statement;</div><div class="line">&#125; else &#123;</div><div class="line">    statement2;</div><div class="line">&#125;</div><div class="line"></div><div class="line">if (expression) &#123;</div><div class="line">    statement1;</div><div class="line">&#125; else if (expression1) &#123;</div><div class="line">    statement2;</div><div class="line">&#125; else &#123;</div><div class="line">    statement3;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"> </div><div class="line"></div><div class="line">统计某个文件夹下的文件占用的字节数,过滤4096大小的文件(一般都是文件夹):</div><div class="line"></div><div class="line">ls -l |awk &apos;BEGIN &#123;size=0;print &quot;[start]size is &quot;, size&#125; &#123;if($5!=4096)&#123;size=size+$5;&#125;&#125; END&#123;print &quot;[end]size is &quot;, size/1024/1024,&quot;M&quot;&#125;&apos; </div><div class="line">[end]size is  8.22339 M</div><div class="line"> </div><div class="line"></div><div class="line">循环语句</div><div class="line"></div><div class="line">awk中的循环语句同样借鉴于C语言，支持while、do/while、for、break、continue，这些关键字的语义和C语言中的语义完全相同。</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">数组</div><div class="line"></div><div class="line">  因为awk中数组的下标可以是数字和字母，数组的下标通常被称为关键字(key)。值和关键字都存储在内部的一张针对key/value应用hash的表格里。由于hash不是顺序存储，因此在显示数组内容时会发现，它们并不是按照你预料的顺序显示出来的。数组和变量一样，都是在使用时自动创建的，awk也同样会自动判断其存储的是数字还是字符串。一般而言，awk中的数组用来从记录中收集信息，可以用于计算总和、统计单词以及跟踪模板被匹配的次数等等。</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">显示/etc/passwd的账户</div><div class="line"></div><div class="line"> </div><div class="line">awk -F &apos;:&apos; &apos;BEGIN &#123;count=0;&#125; &#123;name[count] = $1;count++;&#125;; END&#123;for (i = 0; i &lt; NR; i++) print i, name[i]&#125;&apos; /etc/passwd</div><div class="line">0 root</div><div class="line">1 daemon</div><div class="line">2 bin</div><div class="line">3 sys</div><div class="line">4 sync</div><div class="line">5 games</div><div class="line">......</div><div class="line"> </div><div class="line">这里使用for循环遍历数组</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">awk编程的内容极多，这里只罗列简单常用的用法，更多请参考 http://www.gnu.org/software/gawk/manual/gawk.html</div></pre></td></tr></table></figure></p>
<h3 id="crontab-定时任务"><a href="#crontab-定时任务" class="headerlink" title="crontab 定时任务"></a>crontab 定时任务</h3><p>基本格式 :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">*　　*　　*　　*　　*　　command </div><div class="line"></div><div class="line"></div><div class="line">分　 时　 日　 月　 周　 命令 </div><div class="line">第1列表示分钟1〜59 每分钟用*或者 */1表示 </div><div class="line">第2列表示小时0〜23（0表示0点） </div><div class="line">第3列表示日期1〜31 </div><div class="line">第4列表示月份1〜12 </div><div class="line">第5列标识号星期0〜6（0表示星期天） </div><div class="line">第6列要运行的命令</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line">crontab文件的一些例子： </div><div class="line">30 21 * * * /usr/local/etc/rc.d/lighttpd restart </div><div class="line">上面的例子表示每晚的21:30重启apache。 </div><div class="line">45 4 1,10,22 * * /usr/local/etc/rc.d/lighttpd restart </div><div class="line">上面的例子表示每月1、10、22日的4 : 45重启apache。 </div><div class="line">10 1 * * 6,0 /usr/local/etc/rc.d/lighttpd restart </div><div class="line">上面的例子表示每周六、周日的1 : 10重启apache。 </div><div class="line">0,30 18-23 * * * /usr/local/etc/rc.d/lighttpd restart </div><div class="line">上面的例子表示在每天18 : 00至23 : 00之间每隔30分钟重启apache。 </div><div class="line">0 23 * * 6 /usr/local/etc/rc.d/lighttpd restart </div><div class="line">上面的例子表示每星期六的11 : 00 pm重启apache。 </div><div class="line">* */1 * * * /usr/local/etc/rc.d/lighttpd restart </div><div class="line">每一小时重启apache </div><div class="line">* 23-7/1 * * * /usr/local/etc/rc.d/lighttpd restart </div><div class="line">晚上11点到早上7点之间，每隔一小时重启apache </div><div class="line">0 11 4 * mon-wed /usr/local/etc/rc.d/lighttpd restart </div><div class="line">每月的4号与每周一到周三的11点重启apache </div><div class="line">0 4 1 jan * /usr/local/etc/rc.d/lighttpd restart </div><div class="line">一月一号的4点重启apache </div><div class="line">名称 : crontab </div><div class="line">使用权限 : 所有使用者 </div><div class="line">使用方式 : </div><div class="line">crontab file [-u user]-用指定的文件替代目前的crontab。 </div><div class="line">crontab-[-u user]-用标准输入替代目前的crontab. </div><div class="line">crontab-1[user]-列出用户目前的crontab. </div><div class="line">crontab-e[user]-编辑用户目前的crontab. </div><div class="line">crontab-d[user]-删除用户目前的crontab. </div><div class="line">crontab-c dir- 指定crontab的目录。 </div><div class="line">crontab文件的格式：M H D m d cmd. </div><div class="line">M: 分钟（0-59）。 </div><div class="line">H：小时（0-23）。 </div><div class="line">D：天（1-31）。 </div><div class="line">m: 月（1-12）。 </div><div class="line">d: 一星期内的天（0~6，0为星期天）。 </div><div class="line">cmd要运行的程序，程序被送入sh执行，这个shell只有USER,HOME,SHELL这三个环境变量 </div><div class="line">说明 : </div><div class="line">crontab 是用来让使用者在固定时间或固定间隔执行程序之用，换句话说，也就是类似使用者的时程表。-u user 是指设定指定 </div><div class="line">user 的时程表，这个前提是你必须要有其权限(比如说是 root)才能够指定他人的时程表。如果不使用 -u user 的话，就是表示设 </div><div class="line">定自己的时程表。 </div><div class="line">参数 : </div><div class="line">crontab -e : 执行文字编辑器来设定时程表，内定的文字编辑器是 VI，如果你想用别的文字编辑器，则请先设定 VISUAL 环境变数 </div><div class="line">来指定使用那个文字编辑器(比如说 setenv VISUAL joe) </div><div class="line">crontab -r : 删除目前的时程表 </div><div class="line">crontab -l : 列出目前的时程表 </div><div class="line">crontab file [-u user]-用指定的文件替代目前的crontab。 </div><div class="line">时程表的格式如下 : </div><div class="line">f1 f2 f3 f4 f5 program </div><div class="line">其中 f1 是表示分钟，f2 表示小时，f3 表示一个月份中的第几日，f4 表示月份，f5 表示一个星期中的第几天。program 表示要执 </div><div class="line">行的程序。 </div><div class="line">当 f1 为 * 时表示每分钟都要执行 program，f2 为 * 时表示每小时都要执行程序，其馀类推 </div><div class="line">当 f1 为 a-b 时表示从第 a 分钟到第 b 分钟这段时间内要执行，f2 为 a-b 时表示从第 a 到第 b 小时都要执行，其馀类推 </div><div class="line">当 f1 为 */n 时表示每 n 分钟个时间间隔执行一次，f2 为 */n 表示每 n 小时个时间间隔执行一次，其馀类推 </div><div class="line">当 f1 为 a, b, c,... 时表示第 a, b, c,... 分钟要执行，f2 为 a, b, c,... 时表示第 a, b, c...个小时要执行，其馀类推 </div><div class="line">使用者也可以将所有的设定先存放在档案 file 中，用 crontab file 的方式来设定时程表。 </div><div class="line">例子 : </div><div class="line">#每天早上7点执行一次 /bin/ls : </div><div class="line">0 7 * * * /bin/ls </div><div class="line">在 12 月内, 每天的早上 6 点到 12 点中，每隔3个小时执行一次 /usr/bin/backup : </div><div class="line">0 6-12/3 * 12 * /usr/bin/backup </div><div class="line">周一到周五每天下午 5:00 寄一封信给 alex@domain.name : </div><div class="line">0 17 * * 1-5 mail -s &quot;hi&quot; alex@domain.name &lt; /tmp/maildata </div><div class="line">每月每天的午夜 0 点 20 分, 2 点 20 分, 4 点 20 分....执行 echo &quot;haha&quot; </div><div class="line">20 0-23/2 * * * echo &quot;haha&quot; </div><div class="line">注意 : </div><div class="line">当程序在你所指定的时间执行后，系统会寄一封信给你，显示该程序执行的内容，若是你不希望收到这样的信，请在每一行空一格之 </div><div class="line">后加上 &gt; /dev/null 2&gt;&amp;1 即可 </div><div class="line">例子2 : </div><div class="line">#每天早上6点10分 </div><div class="line">10 6 * * * date </div><div class="line">#每两个小时 </div><div class="line">0 */2 * * * date </div><div class="line">#晚上11点到早上8点之间每两个小时，早上8点 </div><div class="line">0 23-7/2，8 * * * date </div><div class="line">#每个月的4号和每个礼拜的礼拜一到礼拜三的早上11点 </div><div class="line">0 11 4 * mon-wed date </div><div class="line">#1月份日早上4点 </div><div class="line">0 4 1 jan * date </div><div class="line">范例 </div><div class="line">$crontab -l 列出用户目前的crontab.</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/linux/" rel="tag"># linux</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/03/15/spring源码解析转-收藏/" rel="next" title="spring源码解析（转-收藏）">
                <i class="fa fa-chevron-left"></i> spring源码解析（转-收藏）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/03/15/linux基础命令1/" rel="prev" title="linux基础命令(1)">
                linux基础命令(1) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
     <!-- 多说评论框 start -->  
        <div class="ds-thread" data-thread-key="<%- page.path %>" data-title="<%- page.title %>" data-url="<%- page.permalink %>"></div>  
<!-- 多说评论框 end -->  
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"dearas"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end --> 


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/image/headimage.jpg"
               alt="knight_ka" />
          <p class="site-author-name" itemprop="name">knight_ka</p>
          <p class="site-description motion-element" itemprop="description">努力 是为了不让自己永远都‘无能为力’。用一生去诠释‘自强不息’的涵义。</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">39</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">23</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/DearAS" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#linux基础命令3"><span class="nav-number">1.</span> <span class="nav-text">linux基础命令3</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#iptables防火墙"><span class="nav-number">1.1.</span> <span class="nav-text">iptables防火墙</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#禁止192-168-33-0网段从eth0网卡接入"><span class="nav-number">1.1.1.</span> <span class="nav-text">禁止192.168.33.0网段从eth0网卡接入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#禁止ip地址非192-168-10-10的所有类型数据接入"><span class="nav-number">1.1.2.</span> <span class="nav-text">禁止ip地址非192.168.10.10的所有类型数据接入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#禁止ip地址非192-168-10-10的ping请求"><span class="nav-number">1.1.3.</span> <span class="nav-text">禁止ip地址非192.168.10.10的ping请求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#扩展匹配：1-隐式扩展-2-显示扩展"><span class="nav-number">1.1.4.</span> <span class="nav-text">扩展匹配：1.隐式扩展 2.显示扩展</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#匹配端口范围"><span class="nav-number">1.1.5.</span> <span class="nav-text">匹配端口范围</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#匹配多个端口"><span class="nav-number">1.1.6.</span> <span class="nav-text">匹配多个端口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#不允许源端口为80的数据流出"><span class="nav-number">1.1.7.</span> <span class="nav-text">不允许源端口为80的数据流出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#soct-cut-wc详解"><span class="nav-number">1.1.8.</span> <span class="nav-text">soct cut wc详解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#uniq"><span class="nav-number">1.1.8.1.</span> <span class="nav-text">uniq</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#cut命令"><span class="nav-number">1.1.8.2.</span> <span class="nav-text">cut命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#wc"><span class="nav-number">1.1.8.3.</span> <span class="nav-text">wc</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sed操作文本"><span class="nav-number">1.1.9.</span> <span class="nav-text">sed操作文本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#awk操作文本"><span class="nav-number">1.1.10.</span> <span class="nav-text">awk操作文本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#crontab-定时任务"><span class="nav-number">1.1.11.</span> <span class="nav-text">crontab 定时任务</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">knight_ka</span>
</div>


<div class="powered-by">
  笔记小站
</div>

<div class="theme-info">
  knight_ka -
  <a class="theme-link">
    
  </a>
<span id="busuanzi_container_site_pv">
    pv: <span id="busuanzi_value_site_pv"></span> |
</span>
<span id="busuanzi_container_site_uv">
  uv: <span id="busuanzi_value_site_uv"></span>
</span>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"dearas"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  












  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("AXx3tQgn1oh9iMbb6uO5gdIC-gzGzoHsz", "lQa5xdYNyn1Y5F3wMiARKtvO");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


</body>
</html>
